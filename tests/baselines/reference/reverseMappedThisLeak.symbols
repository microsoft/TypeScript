//// [tests/cases/compiler/reverseMappedThisLeak.ts] ////

=== reverseMappedThisLeak.ts ===
declare function test<T extends Record<string, unknown>>(obj:{
>test : Symbol(test, Decl(reverseMappedThisLeak.ts, 0, 0))
>T : Symbol(T, Decl(reverseMappedThisLeak.ts, 0, 22))
>Record : Symbol(Record, Decl(lib.es5.d.ts, --, --))
>obj : Symbol(obj, Decl(reverseMappedThisLeak.ts, 0, 57))

  [K in keyof T]: () => T[K];
>K : Symbol(K, Decl(reverseMappedThisLeak.ts, 1, 3))
>T : Symbol(T, Decl(reverseMappedThisLeak.ts, 0, 22))
>T : Symbol(T, Decl(reverseMappedThisLeak.ts, 0, 22))
>K : Symbol(K, Decl(reverseMappedThisLeak.ts, 1, 3))

}): T;
>T : Symbol(T, Decl(reverseMappedThisLeak.ts, 0, 22))

const obj = test({
>obj : Symbol(obj, Decl(reverseMappedThisLeak.ts, 4, 5))
>test : Symbol(test, Decl(reverseMappedThisLeak.ts, 0, 0))

  a() {
>a : Symbol(a, Decl(reverseMappedThisLeak.ts, 4, 18))

    return 1;
  },
  b() {
>b : Symbol(b, Decl(reverseMappedThisLeak.ts, 7, 4))

    return this.a();
>this.a : Symbol(a, Decl(reverseMappedThisLeak.ts, 4, 18))
>this : Symbol(__type, Decl(reverseMappedThisLeak.ts, 0, 61))
>a : Symbol(a, Decl(reverseMappedThisLeak.ts, 4, 18))

    // Expected: number
    // Actual: T[string] (bug)
  }
});

obj.b(); // should be `number`, but currently inferred as `T[string]`
>obj.b : Symbol(b, Decl(reverseMappedThisLeak.ts, 7, 4))
>obj : Symbol(obj, Decl(reverseMappedThisLeak.ts, 4, 5))
>b : Symbol(b, Decl(reverseMappedThisLeak.ts, 7, 4))

